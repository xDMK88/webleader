<script setup>
import { mdiCog } from '@mdi/js'
import { computed } from 'vue'
import Icon from '@/components/Icon.vue'
import { useStore } from 'vuex'

const props = defineProps({
  title: {
    type: String,
    default: null
  },
  icon: {
    type: String,
    default: null
  },
  headerIcon: {
    type: String,
    default: null
  },
  rounded: {
    type: String,
    default: 'rounded-md'
  },
  hasTable: Boolean,
  accMod: Boolean,
  empty: Boolean,
  form: Boolean,
  hoverable: Boolean
})

const emit = defineEmits(['header-icon-click', 'submit'])

const is = computed(() => props.form ? 'form' : 'div')

const navig = computed(() => store.state.navig)

const store = useStore()

const user = computed(() => store.state.user.user)

const componentClass = computed(() => {
  const base = [
    props.rounded
  ]

  if (props.hoverable) {
    base.push('hover:shadow-lg transition-shadow duration-500')
  }

  return base
})

const computedHeaderIcon = computed(() => props.headerIcon ?? mdiCog)

const tarif = () => {
  store.commit('basic', { key: 'navig', value: 1 })
}

const acc = () => {
  store.commit('basic', { key: 'navig', value: 0 })
}

const option = () => {
  store.commit('basic', { key: 'navig', value: 2 })
}
const headerIconClick = () => {
  emit('header-icon-click')
}
const submit = e => {
  emit('submit', e)
}
</script>

<template>
  <component
    :is="is"
    :class="componentClass"
    class="bg-white dark:bg-zinc-900"
    @submit="submit"
  >
  <fieldset class="flex h-full">
    <form
    class=" bg-gray-100 rounded-l-md pd-0 pl-4 pr-4 pt-3"
    v-if="title">
    <h1 class="pl-3 pb-5 font-bold">Настройки</h1>
    <div>
      <div
      class="px-3 py-1 flex text-center rounded-md hover:bg-gray-200"
      :class="{'bg-gray-200':navig === 0 || navig === 3 }"
      @click="acc"
      >
      <svg width="24" height="29" viewBox="0 0 24 29" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M16.28 13.16C18.08 11.84 19.28 9.68 19.28 7.28C19.28 3.28 16 0 12 0C8 0 4.72 3.28 4.72 7.28C4.72 9.68 5.92 11.84 7.72 13.16C3.2 14.88 0 19.24 0 24.36C0 26.56 1.8 28.36 4 28.36H20C22.2 28.36 24 26.56 24 24.36C24 19.24 20.8 14.88 16.28 13.16ZM6.92 7.28C6.92 4.48 9.2 2.2 12 2.2C14.8 2.2 17.08 4.48 17.08 7.28C17.08 10.08 14.8 12.36 12 12.36C9.2 12.36 6.92 10.08 6.92 7.28ZM20 26.2H4C3 26.2 2.2 25.4 2.2 24.4C2.2 19 6.6 14.6 12 14.6C17.4 14.6 21.8 19 21.8 24.4C21.8 25.36 21 26.2 20 26.2Z" fill="#FF9123"/>
        </svg>
        <button class="ml-3" type="button">
          Аккаунт
        </button>
      </div>
      <div
      class="px-3 mt-1 py-1 flex text-center rounded-md hover:bg-gray-200"
      :class="{'bg-gray-200':navig === 1}"
      @click="tarif"
      >
      <svg width="28" height="32" viewBox="0 0 28 32" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M2 0.5C0.895431 0.5 0 1.39543 0 2.5V4.42076C0 8.08112 2.17694 11.368 5.59249 12.7873C5.78016 14.9536 6.79357 16.9332 8.44504 18.3899C9.30831 19.1369 9.87132 20.1454 10.0965 21.2286H7.43164V24.9263H5.59249V29.5204H3.71582V31.5H24.2467V29.5204H22.4075V24.9263H20.5684V21.2286H17.9035C18.1287 20.1454 18.7292 19.1369 19.555 18.3899C21.2064 16.9706 22.2198 14.9536 22.4075 12.7873C25.7855 11.368 28 8.08112 28 4.42076V2.5C28 1.39543 27.1046 0.5 26 0.5H2ZM25.9357 2.47959V4.42076C25.9357 6.9606 24.5845 9.27634 22.37 10.5463V2.47959H25.9357ZM9.42091 24.9263V23.2455H18.5416V24.9263H9.42091ZM18.2038 16.8959C16.9276 18.0164 16.0643 19.5478 15.8391 21.2286H12.1609C11.9357 19.5478 11.0724 18.0164 9.79625 16.8959C8.40751 15.7007 7.6193 13.9452 7.6193 12.115V2.47959H20.4182V12.0776C20.3807 13.9452 19.555 15.7007 18.2038 16.8959ZM7.54424 29.5204V26.9059H20.3432V29.5204H7.54424ZM5.55496 10.5836C3.37802 9.31369 1.98928 6.9606 1.98928 4.42076V2.47959H5.55496V10.5836Z" fill="#FF9F0A"/>
        </svg>
        <button  class="ml-3" type="button">
          Тариф
        </button>
      </div>
      <div class="px-3 mt-1 py-1 flex text-center rounded-md hover:bg-gray-200"
      :class="{'bg-gray-200':navig === 2}"
      @click="option"
      >
        <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M26.6953 11.3981H26.1554C25.9755 10.8132 25.7505 10.2733 25.4805 9.73342L25.8405 9.37348C26.3804 8.83358 26.6503 8.15869 26.6503 7.43882C26.6503 6.71894 26.3804 5.99907 25.8405 5.50416L24.5807 4.19938C24.0408 3.65948 23.3659 3.38952 22.646 3.38952C21.9262 3.38952 21.2063 3.65948 20.7114 4.19938L20.3514 4.55932C19.8115 4.28937 19.2716 4.06441 18.6867 3.88444V3.34453C18.6867 1.8148 17.4719 0.600006 15.9422 0.600006H14.1425C12.6128 0.600006 11.398 1.8148 11.398 3.34453V3.88444C10.8131 4.06441 10.2732 4.28937 9.73327 4.55932L9.32834 4.19938C8.78843 3.65948 8.11355 3.38952 7.39367 3.38952C6.6738 3.38952 5.95392 3.65948 5.45901 4.19938L4.19923 5.45916C3.70431 5.95408 3.38937 6.67395 3.38937 7.39383C3.38937 8.1137 3.65932 8.83358 4.19923 9.32849L4.55917 9.68843C4.28921 10.2283 4.06425 10.7682 3.88428 11.3531H3.34438C1.81464 11.3981 0.599854 12.6129 0.599854 14.1427V15.9423C0.599854 17.4721 1.81464 18.6869 3.34438 18.6869H3.88428C4.06425 19.2718 4.28921 19.8117 4.55917 20.3516L4.19923 20.7115C3.65932 21.2514 3.38937 21.9263 3.38937 22.6462C3.38937 23.3661 3.65932 24.0859 4.19923 24.5808L5.45901 25.8406C5.99892 26.3805 6.6738 26.6505 7.39367 26.6505C8.11355 26.6505 8.83342 26.3805 9.32834 25.8406L9.68828 25.4807C10.2282 25.7506 10.7681 25.9756 11.353 26.1556V26.6955C11.353 28.2252 12.5678 29.44 14.0975 29.44H15.8972C17.4269 29.44 18.6417 28.2252 18.6417 26.6955V26.1556C19.2266 25.9756 19.7665 25.7506 20.3064 25.4807L20.6664 25.8406C21.2063 26.3805 21.8812 26.6505 22.601 26.6505C23.3209 26.6505 24.0408 26.3805 24.5357 25.8406L25.7955 24.5808C26.3354 24.0409 26.6053 23.3661 26.6053 22.6462C26.6053 21.9263 26.3354 21.2064 25.7955 20.7115L25.4355 20.3516C25.7055 19.8117 25.9305 19.2718 26.1104 18.6869H26.6953C28.2251 18.6869 29.4398 17.4721 29.4398 15.9423V14.1427C29.4398 12.6129 28.2251 11.3981 26.6953 11.3981ZM24.5357 17.4721C24.3107 18.3719 23.9508 19.2268 23.5009 19.9916C23.2759 20.3516 23.3209 20.8465 23.6359 21.1614L24.5357 22.0613C24.7157 22.2413 24.7607 22.4212 24.7607 22.6462C24.7607 22.8711 24.6707 23.0961 24.4907 23.2311L23.2309 24.4909C23.051 24.6708 22.871 24.7158 22.646 24.7158C22.4211 24.7158 22.1961 24.6258 22.0611 24.4459L21.2063 23.591C21.0263 23.411 20.8013 23.3211 20.5314 23.3211C20.3514 23.3211 20.1715 23.3661 20.0365 23.456C19.2266 23.906 18.3718 24.2659 17.5169 24.4909C17.112 24.5808 16.797 24.9858 16.797 25.3907V26.6955C16.797 27.1454 16.4371 27.5503 15.9422 27.5503H14.1425C13.6926 27.5503 13.2877 27.1904 13.2877 26.6955V25.4357C13.2877 24.9858 12.9727 24.6258 12.5678 24.5359C11.6679 24.3109 10.8131 23.951 10.0482 23.501C9.91324 23.411 9.73327 23.3661 9.5533 23.3661C9.28335 23.3661 9.05839 23.456 8.87842 23.636L7.97857 24.5359C7.7986 24.7158 7.61864 24.8058 7.39367 24.8058C7.16871 24.8058 6.94375 24.7158 6.80878 24.5359L5.549 23.2311C5.36903 23.0511 5.32403 22.8711 5.32403 22.6462C5.32403 22.4212 5.41402 22.1963 5.59399 22.0613L6.49383 21.2064C6.80878 20.8915 6.85377 20.4416 6.62881 20.0366C6.17889 19.2268 5.81895 18.3719 5.59399 17.5171C5.504 17.1121 5.09907 16.7972 4.69414 16.7972H3.34438C2.89446 16.7972 2.48953 16.4373 2.48953 15.9423V14.1427C2.48953 13.6927 2.84946 13.2878 3.34438 13.2878H4.60416C5.05408 13.2878 5.41402 12.9729 5.504 12.5679C5.72896 11.6681 6.0889 10.8132 6.53882 10.0484C6.76378 9.68843 6.71879 9.19351 6.40385 8.87857L5.504 7.97873C5.32403 7.79876 5.23405 7.61879 5.27904 7.39383C5.27904 7.16887 5.36903 6.94391 5.549 6.80893L6.80878 5.54915C6.98875 5.36918 7.16871 5.32419 7.39367 5.32419C7.61864 5.32419 7.8436 5.41417 7.97857 5.59414L8.83342 6.44899C9.01339 6.62896 9.23835 6.71894 9.50831 6.71894C9.68828 6.71894 9.86825 6.67395 10.0032 6.58397C10.8131 6.13405 11.6679 5.77411 12.5228 5.54915C12.9277 5.45916 13.2427 5.05423 13.2427 4.6493V3.34453C13.2427 2.89461 13.6026 2.48968 14.0975 2.48968H15.8972C16.3471 2.48968 16.7521 2.84962 16.7521 3.34453V4.60431C16.7521 5.05423 17.067 5.41417 17.4719 5.50416C18.3718 5.72912 19.2266 6.08905 19.9915 6.53898C20.1265 6.62896 20.3064 6.67395 20.4864 6.67395C20.7564 6.67395 20.9813 6.58397 21.1613 6.404L22.0611 5.50416C22.2411 5.32419 22.4211 5.2342 22.646 5.2342C22.871 5.2342 23.0959 5.32419 23.2309 5.50416L24.4907 6.76394C24.6707 6.94391 24.7157 7.12387 24.7157 7.34883C24.7157 7.5738 24.6257 7.79876 24.4457 7.93373L23.5909 8.78859C23.2759 9.10353 23.2309 9.55345 23.4559 9.95838C23.9058 10.7682 24.2657 11.6231 24.4907 12.4779C24.5807 12.8829 24.9856 13.1978 25.3906 13.1978H26.6953C27.1452 13.1978 27.5502 13.5578 27.5502 14.0527V15.8524C27.5502 16.3023 27.1902 16.7072 26.6953 16.7072H25.4355C25.0306 16.7522 24.6707 17.0671 24.5357 17.4721Z" fill="#FF9123"/>
          <path d="M15.0423 8.6986C11.533 8.6986 8.69845 11.5331 8.69845 15.0425C8.69845 18.5519 11.533 21.3864 15.0423 21.3864C18.5517 21.3864 21.3862 18.5519 21.3862 15.0425C21.3862 11.5331 18.5067 8.6986 15.0423 8.6986ZM15.0423 10.5883C17.4719 10.5883 19.4966 12.5679 19.4966 15.0425C19.4966 17.5171 17.5169 19.4967 15.0423 19.4967C12.5678 19.4967 10.5881 17.5171 10.5881 15.0425C10.5881 12.5679 12.5678 10.5883 15.0423 10.5883Z" fill="#FF9123"/>
          </svg>
        <button  class="ml-3" type="button">
          Основное
        </button>
      </div>
    </div>
        </form>
        <div class="w-full flex-wrap">
        <header
          v-if="title"
          :class="{'bg-[#FFF2E0]': user.license_type == 0, 'bg-[#FFF2E0]': user.license_type == 1, 'bg-[#FFF2E0]': user.license_type == 2, 'bg-[#FFF2E0]': user.license_type == 3}"
          class=" flex w-full h-[7%] items-stretch pb-4 mb-3 mt-2 w-full border-b-[1px] border-gray-100 dark:border-gray-700"
        >
        <a v-if="computedHeaderIcon && navig === 3"
          href="#"
          class="hover:bg-gray-200  flex items-center p-2 ml-2 mt-2 rounded-xl justify-center ring-blue-700"
          aria-label="more options"
          @click="acc">
          <svg width="9" height="15" viewBox="0 0 9 15" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M8.64868 0.678158C8.1846 0.220185 7.43713 0.225135 6.97915 0.689214L1.31249 6.43144C0.884303 6.86533 0.856881 7.55388 1.2492 8.02045L6.47997 14.2412C6.89959 14.7402 7.6443 14.8046 8.14333 14.385C8.64236 13.9654 8.70674 13.2207 8.28712 12.7216L3.74866 7.32423L8.65973 2.34768C9.11771 1.8836 9.11276 1.13613 8.64868 0.678158Z" fill="#575758"/>
            </svg>
          </a>
          <p
            class=" text-center items-center w-fit py-3 grow font-bold"
            :class="[ icon ? 'px-4' : 'px-6' ]"
          >
            <icon
              v-if="icon"
              :path="icon"
              class="mr-3"
            />
            {{ title }}
          </p>
          <a v-if="computedHeaderIcon"
          href="#"
          class="hover:bg-gray-200  flex items-center p-4 mr-2 rounded-xl justify-center ring-blue-700"
          aria-label="more options"
          @click="headerIconClick">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M14.8486 2.84858C15.3172 2.37995 15.3172 1.62015 14.8486 1.15152C14.3799 0.682892 13.6202 0.682892 13.1515 1.15152L8.00005 6.30299L2.84858 1.15152C2.37995 0.682892 1.62015 0.682892 1.15152 1.15152C0.682891 1.62015 0.682891 2.37995 1.15152 2.84858L6.30299 8.00005L1.15152 13.1515C0.682891 13.6202 0.682891 14.3799 1.15152 14.8486C1.62015 15.3172 2.37995 15.3172 2.84858 14.8486L8.00005 9.69711L13.1515 14.8486C13.6202 15.3172 14.3799 15.3172 14.8486 14.8486C15.3172 14.3799 15.3172 13.6202 14.8486 13.1515L9.69711 8.00005L14.8486 2.84858Z" fill="black" fill-opacity="0.5"/>
            </svg>
          </a>
        </header>
        <div
          v-if="empty"
         b class="text-center py-24 text-gray-500 dark:text-gray-400"
        >
          <p>Nothing's here…</p>
        </div>
        <div
          v-else
          class=""
          :class="{'p-6':!hasTable, 'h-[85%] overflow-auto':accMod}"
        >
          <slot />
        </div>
      </div>
      </fieldset>
  </component>
</template>
